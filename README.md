# 日志采集分析系统
### 项目功能

本系统模拟多个日志采集节点：

* 系统中有多个日志采集节点（实验时用多个进程模拟），每个节点用唯一 ID 标识。

* 每个节点模拟不同设备的日志，每隔 100 毫秒生成一条日志消息，并发布到消息队列。

* 日志消息格式（类似JSON格式）如下：

  ```json
  {
  	"device_id": "device_id1",
  	"timestamp": "2025-03-31 12:00:00",
  	"log_level": "INFO/WARN/ERROR",
  	"message": "系统状态正常"
  }
  ```

同时实现一个异常检测与统计分析微服务，订阅所有日志消息，并针对不同device_id的设备分别进行独立的日志分析:

* 维护最近 N 条日志记录，并计算：
  * ERROR 级别日志的占比
  * WARN 级别日志的占比
  * 记录该设备历史日志中的最近一次 ERROR 事件及其时间戳
* 每隔 T 秒（可配置）将分析结果打包成新消息，并发布到消息队列。
* 若在 S秒（可配置）内 ERROR 占比超过 50%，生成严重告警消息并发布到消息队列。

### 项目结构

**entity**包：存放日志实体类。

**queue**包：存放使用消息队列通信模式的日志生成程序和采集分析程序。

**topic**包：存放使用发布订阅通信模式的日志生成程序和采集分析程序。

### 实现思路

**LogProducer**：向消息队列循环发送Message，三种Message使用Random随机发送。

**LogAnalyzer**：运行时包含三个线程：

1. 一个线程用于从消息队列中取出日志并存放到HashMap。
2. 一个线程每T秒分析一次N条日志记录，并将分析结果发布到消息队列。
3. 一个线程每S秒分析S秒内的ERROR占比是否超过50%，超过则发布严重警告消息。
